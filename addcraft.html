<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Add Craft</title>
     <meta charset="UTF-8">
    <title>Add Craft</title>
    <style>
        #itemTable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        #itemTable th, #itemTable td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        #itemTable th {
            background-color: #4CAF50;
            color: white;
        }
        #itemTable tr:hover {
            background-color: #f5f5f5;
        }
        .select-checkbox {
            cursor: pointer;
        }
        .selected-items {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
        }
    </style>
</head>

<body>
    <h1>Add Craft</h1>
    <form id="frmAddProduct" action="./summary.html" method="get">
        <label id="lblcraftcode" for="code">Craft Code:</label><br>
        <input type="number" id="code" name="code" placeholder="Enter the craft code" required><br><br>
        <label id="lblcraftname">Craft name:</label><br>
        <input type="text" id="name" name="name" placeholder="Enter the craft name" required><br><br>
        <label id="lblcategory" for="ddlcategory">Work Category:</label><br>
        <select id="ddlcategory" name="ddlcategory" required>
            <option value="">Select a category</option>
            <option value="Woodwork">Woodwork</option>
            <option value="Metalwork">Metalwork</option>
            <option value="Textiles">Textiles</option>
            <option value="Ceramics">Ceramics</option>
        </select><br><br>
        <label id="lblselection" for="ddlselection">Selection</label><br>
        <select id="ddlselection" name="ddlselection" required>
            <option value="">Select a selection</option>
            <option value="Handmade">Handmade</option>
            <option value="Machine-made">Machine-made</option>
        </select><br><br>
        <label id="lbllocation" for="location">Location:</label><br>
        <input type="text" id="location" name="location" placeholder="Enter the location" required><br><br>
        <label id="lblEstimatedstart" for="Estimatedstart">Estimated start:</label><br>
        <input type="date" id="Estimatedstart" name="Estimatedstart" required><br><br>
        <label id="lblEstimatedend" for="Estimatedend">Estimated end:</label><br>
        <input type="date" id="Estimatedend" name="Estimatedend" required><br><br>
        <label id="lblstatus" for="ddlstatus">Status:</label><br>
        <select id="ddlstatus" name="ddlstatus" required>
            <option value="">Select a status</option>
            <option value="Not Started">Not Started</option>
            <option value="In Progress">In Progress</option>
            <option value="Completed">Completed</option>
        </select><br><br>
        <h1>Total Estimation</h1>
        <label id="lblTotalDays">Total Estimated Days: </label>
        <span id="totalDays" style="font-weight: bold; color: #4CAF50;">0</span> days<br>
        <label id="lblhoursPerDay" for="hoursPerDay">Hours Per Day: </label>
        <input type="number" id="hoursPerDay" name="hoursPerDay" placeholder="Enter hours per day" value="8" min="1" max="24" onchange="calculateEstimation()"><br>
        <label id="lblTotalHours">Total Estimated Hours: </label>
        <span id="totalHours" style="font-weight: bold; color: #4CAF50;">0</span> hours<br><br>
        <label id="lblcostPerHour" for="costPerHour">Cost Per Hour: $</label>
        <input type="number" id="costPerHour" name="costPerHour" placeholder="Enter cost per hour" value="50" min="0" step="0.01" onchange="calculateEstimation()"><br>
        <label id="lblTotalCost">Total Estimation Cost: </label>
        <span id="totalCost" style="font-weight: bold; color: #ff6b6b; font-size: 1.2em;">$0.00</span><br><br>
        <h1>Technical Details</h1>
        <label id="lbltechnicaldetails" for="technicaldetails">Technical Details:</label><br>
        <textarea id="technicaldetails" name="technicaldetails" placeholder="Enter technical details here"
            ></textarea><br><br>
        <label id="lblDescription" for="description">Description:</label><br>
        <input type="text" id="description" name="description" placeholder="Enter a summary of the craft details"
            required><br><br>
            <h1>Drawing reference</h1>
            <label id="lbldrawingreference" for="drawingreference">Drawing reference:</label><br>
        <img src="images/drawing-reference.jpg" alt="Drawing Reference"><br><br>
        
        <h1>Item Association</h1>
        <label id="lblitem" for="searchItem">Search Items:</label><br>
        <input type="search" id="searchItem" name="searchItem" placeholder="Search by item name or code" onkeyup="filterTable()"><br><br>
        
        <table id="itemTable">
            <thead>
                <tr>
                    <th>Select</th>
                    <th>Item ID</th>
                    <th>Item Name</th>
                    <th>Category</th>
                    <th>Quantity</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <tr>
                    <td><input type="checkbox" class="select-checkbox" value="1"></td>
                    <td>1001</td>
                    <td>Wood Block</td>
                    <td>Materials</td>
                    <td>50</td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="select-checkbox" value="2"></td>
                    <td>1002</td>
                    <td>Metal Rod</td>
                    <td>Materials</td>
                    <td>30</td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="select-checkbox" value="3"></td>
                    <td>1003</td>
                    <td>Textile Fabric</td>
                    <td>Materials</td>
                    <td>100</td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="select-checkbox" value="4"></td>
                    <td>1004</td>
                    <td>Clay Batch</td>
                    <td>Materials</td>
                    <td>20</td>
                </tr>
                <tr>
                    <td><input type="checkbox" class="select-checkbox" value="5"></td>
                    <td>1005</td>
                    <td>Drill Machine</td>
                    <td>Tools</td>
                    <td>5</td>
                </tr>
            </tbody>
        </table>
        
        <div class="selected-items">
            <h3>Selected Items:</h3>
            <input type="hidden" id="selectedItems" name="selectedItems">
            <div id="selectedItemsList">No items selected</div>
        </div><br>
        <input type="submit" id="btnSubmit" value="Submit" style="background-color: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
        <input type="submit" id="btnSaveDraft" value="Save Draft" style="background-color: #2196F3; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
        <input type="button" id="btnCancel" value="Cancel" onclick="confirmCancel()" style="background-color: #f44336; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">
    </form>

    <script>
        // Filter table based on search input
        function filterTable() {
            const searchValue = document.getElementById('searchItem').value.toLowerCase();
            const tableRows = document.querySelectorAll('#tableBody tr');
            
            tableRows.forEach(row => {
                const itemName = row.cells[2].textContent.toLowerCase();
                const itemId = row.cells[1].textContent.toLowerCase();
                
                if (itemName.includes(searchValue) || itemId.includes(searchValue)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
        
        // Handle checkbox selection
        document.querySelectorAll('.select-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', updateSelectedItems);
        });
        
        function updateSelectedItems() {
            const selectedCheckboxes = document.querySelectorAll('.select-checkbox:checked');
            const selectedItems = [];
            let selectedItemsList = '';
            
            selectedCheckboxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const itemId = row.cells[1].textContent;
                const itemName = row.cells[2].textContent;
                
                selectedItems.push({
                    id: itemId,
                    name: itemName
                });
                
                selectedItemsList += `<p>â€¢ ${itemName} (ID: ${itemId})</p>`;
            });
            
            // Update the hidden field with selected items
            document.getElementById('selectedItems').value = JSON.stringify(selectedItems);
            
            // Update the display
            const listDiv = document.getElementById('selectedItemsList');
            if (selectedItemsList === '') {
                listDiv.innerHTML = 'No items selected';
            } else {
                listDiv.innerHTML = selectedItemsList;
            }
        }
        
        // Calculate total estimation (days, hours, and cost)
        function calculateEstimation() {
            const startDate = new Date(document.getElementById('Estimatedstart').value);
            const endDate = new Date(document.getElementById('Estimatedend').value);
            const hoursPerDay = parseInt(document.getElementById('hoursPerDay').value) || 8;
            const costPerHour = parseFloat(document.getElementById('costPerHour').value) || 0;
            
            if (startDate && endDate && startDate <= endDate) {
                // Calculate difference in days
                const timeDifference = endDate - startDate;
                const totalDays = Math.ceil(timeDifference / (1000 * 60 * 60 * 24)) + 1;
                const totalHours = totalDays * hoursPerDay;
                const totalCost = totalHours * costPerHour;
                
                document.getElementById('totalDays').textContent = totalDays;
                document.getElementById('totalHours').textContent = totalHours;
                document.getElementById('totalCost').textContent = '$' + totalCost.toFixed(2);
            } else {
                document.getElementById('totalDays').textContent = '0';
                document.getElementById('totalHours').textContent = '0';
                document.getElementById('totalCost').textContent = '$0.00';
            }
        }
        
        // Add event listeners for date changes and cost inputs
        document.getElementById('Estimatedstart').addEventListener('change', calculateEstimation);
        document.getElementById('Estimatedend').addEventListener('change', calculateEstimation);
        
        // Cancel button functionality
        function confirmCancel() {
            if (confirm('Are you sure you want to cancel? Any unsaved changes will be lost.')) {
                window.history.back();
            }
        }
        
        // Save Draft functionality - Save form data to localStorage
        document.getElementById('btnSaveDraft').addEventListener('click', function(event) {
            event.preventDefault();
            
            // Collect all form data
            const formData = {
                code: document.getElementById('code').value,
                name: document.getElementById('name').value,
                ddlcategory: document.getElementById('ddlcategory').value,
                ddlselection: document.getElementById('ddlselection').value,
                location: document.getElementById('location').value,
                Estimatedstart: document.getElementById('Estimatedstart').value,
                Estimatedend: document.getElementById('Estimatedend').value,
                ddlstatus: document.getElementById('ddlstatus').value,
                hoursPerDay: document.getElementById('hoursPerDay').value,
                costPerHour: document.getElementById('costPerHour').value,
                technicaldetails: document.getElementById('technicaldetails').value,
                description: document.getElementById('description').value,
                selectedItems: document.getElementById('selectedItems').value,
                timestamp: new Date().toLocaleString()
            };
            
            // Save to localStorage
            localStorage.setItem('craftFormDraft', JSON.stringify(formData));
            
            // Show confirmation message
            alert('Draft saved successfully at ' + formData.timestamp);
        });
    </script>
</body>

</html>
